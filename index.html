<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jesus Rodriguez">

<title>Lab: List Processing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab: List Processing</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jesus Rodriguez </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>You can see the purpose of this assignment as well as the skills and knowledge you should be using and acquiring, in the <a href="tilt.qmd">Transparency in Learning and Teaching (TILT)</a> document in this repository. The TILT document also contains a checklist for self-reflection that will provide some guidance on how the assignment will be graded.</p>
</div>
</div>
</div>
<section id="data-source" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Source</h1>
<p>JSON data files for this assignment were obtained from the TVMaze API for three different Doctor Who series as well as two different spin-offs.</p>
<ul>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/72724/doctor-who">2023-2025</a></li>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/210/doctor-who">2005-2022</a></li>
<li>Dr.&nbsp;Who <a href="https://www.tvmaze.com/shows/766/doctor-who">1963-1996</a></li>
<li><a href="https://www.tvmaze.com/shows/970/the-sarah-jane-adventures">The Sarah Jane Adventures (2007-2020)</a></li>
<li><a href="https://www.tvmaze.com/shows/659/torchwood">Torchwood (2006-2011)</a></li>
<li><a href="https://www.tvmaze.com/shows/26694/torchwood-web-of-lies">Torchwood: Web of Lies (2011)</a></li>
</ul>
</section>
<section id="warming-up" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Warming Up</h1>
<p>For this portion of the assignment, only work with the canonical Dr.&nbsp;Who files (drwho2023.json, drwho2005.json, drwho1963.json).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load neccessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rvest)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xml2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="parse-the-file" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="parse-the-file"><span class="header-section-number">2.1</span> Parse the file</h2>
<p>Add a code chunk that will read each of the JSON files in. Store the data in a <code>drwhoYYYY</code> object, where <code>YYYY</code> is the first year the series began to air. How are the data objects stored?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>drwho2023 <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">read_json</span>(<span class="st">"drwho-72724.json"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>drwho2005 <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"drwho-210.json"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>drwho1963 <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"drwho-766.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The 2023 data is stored as a list of 16.</p>
<p>The 2005 and 1963 are stored as a large list with 153 elements and 700 elements, respectively.</p>
<p><strong>Tibbles</strong></p>
<p>The following two tibbles work fine and can be opened in the environment.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>tibble_2023 <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"drwho-72724.json"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_df</span>(as_tibble)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>tibble_2005 <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"drwho-210.json"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_df</span>(as_tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, the 1963 json file is having problems being turned into a tibble as there are some entries with NULL image values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tibble_1963 <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"drwho-766.json"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_df</span>(as_tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `map()`:
â„¹ In index: 14.
Caused by error in `.f()`:
! All columns in a tibble must be vectors.
âœ– Column `image` is NULL.</code></pre>
</div>
</div>
<hr>
</section>
<section id="examining-list-data-structures" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="examining-list-data-structures"><span class="header-section-number">2.2</span> Examining List Data Structures</h2>
<p>Create a nested markdown list showing what variables are nested at each level of the JSON file. Include an â€˜episodeâ€™ object that is a stand-in for a generic episode (e.g.&nbsp;donâ€™t create a list with all 700+ episodes in it, just show what a single episode has). Make sure you use proper markdown formatting to ensure that the lists are rendered properly when you compile your document.</p>
<p>Hint: The <code>prettify()</code> function in the R package <code>jsonlite</code> will spit out a better-formatted version of a JSON file.</p>
<hr>
<p>Here is how the first entry in <code>drwho2023</code> is contained</p>
<p><code>drwho2023[[1]]</code></p>
<ul>
<li><p>id</p></li>
<li><p>url</p></li>
<li><p>name</p></li>
<li><p>season</p></li>
<li><p>number</p></li>
<li><p>type</p></li>
<li><p>airdate</p></li>
<li><p>airtime</p></li>
<li><p>airstamp</p></li>
<li><p>runtime</p></li>
<li><p>rating</p></li>
<li><p><code>rating$average</code></p></li>
<li><p>image</p></li>
<li><p><code>image$medium</code></p></li>
<li><p><code>image$original</code></p></li>
<li><p>summary</p></li>
<li><p>_links</p></li>
<li><p><code>links$self</code></p></li>
<li><p><code>links$self$href</code></p></li>
<li><p><code>links$show</code></p></li>
<li><p><code>links$show$href</code></p></li>
<li><p><code>links$show$name</code></p></li>
</ul>
<hr>
<p>Is there any information stored in the list structure that you feel is redundant? If so, why?</p>
<ul>
<li><p>rating</p></li>
<li><p><code>rating$average</code> shouldnâ€™t be nested in rating</p></li>
<li><p>It would be better to just have an un-nested average_rating variable instead</p></li>
<li><p>image and links</p></li>
<li><p>these can most likely be split into separate columns respectively</p></li>
</ul>
<p>use nest() function to deal with lists &gt;= 2</p>
</section>
<section id="develop-a-strategy" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="develop-a-strategy"><span class="header-section-number">2.3</span> Develop A Strategy</h2>
<p>Consider what information you would need to examine the structure of Dr.&nbsp;Who episodes over time (show runtime, season length, specials) as well as the ratings, combining information across all three data files.</p>
<p>Sketch one or more rectangular data tables that look like your expected output. Remember that if you link to an image, you must link to something with a picture extension (<code>.png</code>, <code>.jpg</code>), and if you reference a file it should be using a local path and you must also add the picture to your git repository.</p>
<hr>
<p>Sketch goes here</p>
<hr>
<p>What operations will you need to perform to get the data into a form matching your sketch? Make an ordered list of steps you need to take.</p>
<hr>
<ol type="1">
<li>Make an <code>era_information_data</code> table</li>
</ol>
<ul>
<li>Use the html tvmaze url located in <code>links$show$href</code> to scrape information such as <code>Era_ID</code>, <code>Premier_Date</code>, <code>End_Date</code>, <code>Average_Runtime</code>.</li>
</ul>
<ol start="2" type="1">
<li>Make an <code>episode_information_data</code> table</li>
</ol>
<ul>
<li>Make an entry in the <code>drwhoXXXX</code> json files be mapped as a dataframe row.</li>
<li>Add an <code>Era_ID</code> column to be able to filter and know what episodes are from each era</li>
</ul>
<ol start="3" type="1">
<li>Make a <code>season_information_data</code> table</li>
</ol>
<ul>
<li>With the <code>Era_ID</code> and <code>season</code> variables as a key, list the <code>average_runtime</code>, <code>season_length</code>, <code>number_of_episodes</code>, and <code>number of specials</code></li>
</ul>
</section>
<section id="implement-your-strategy" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="implement-your-strategy"><span class="header-section-number">2.4</span> Implement Your Strategy</h2>
<p>Add a code chunk that will convert the JSON files into the table(s) you sketched above. Make sure that the resulting tables have the correct variable types (e.g., dates should not be stored as character variables).</p>
<p>Print out the first 5 rows of each table that you create (but no more)!</p>
<section id="making-the-era-information-table" class="level3">
<h3 class="anchored" data-anchor-id="making-the-era-information-table">Making the Era Information Table</h3>
<p>Checking where the json urls for each show are</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>drwho1963[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>drwho2005[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>drwho2023[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Making a list that contains all 3 eras / all 3 json files of our drwho data.</p>
<p>The id of the list is named according to the era the drwho show takes place in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>drwho_eras <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Classic"</span> <span class="ot">=</span> drwho1963,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Revival"</span> <span class="ot">=</span> drwho2005,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Modern"</span> <span class="ot">=</span> drwho2023</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Scraping the show links:</p>
<ul>
<li>https://api.tvmaze.com/shows/766</li>
<li>https://api.tvmaze.com/shows/210</li>
<li>https://api.tvmaze.com/shows/72724</li>
</ul>
<p>From each drwhoXXXX json file</p>
<!-- # ```{r} -->
<!-- # get_show_links <-  -->
<!-- #     function(drwhoXXXX, eras) { -->
<!-- #         tibble( -->
<!-- #             era = eras, -->
<!-- #             json_link = drwhoXXXX[[1]]$`_links`$show$href -->
<!-- #         ) -->
<!-- #     } -->
<!-- # ``` -->
<p>Fixing the nodes function</p>
<ul>
<li>Basically I am getting the information Iâ€™d like to present</li>
</ul>
<p>I believe the following variables are necessary to do an analysis on the structure of Dr.&nbsp;Who episodes over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fix_era_nodes <span class="ot">&lt;-</span> <span class="cf">function</span>(i) { </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">era_id =</span> i<span class="sc">$</span>id, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">url =</span> i<span class="sc">$</span>url, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">name =</span> i<span class="sc">$</span>name, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> i<span class="sc">$</span>type,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">status =</span> i<span class="sc">$</span>status,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">average_runtime =</span> i<span class="sc">$</span>averageRuntime,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">premiere_date =</span> i<span class="sc">$</span>premiered,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">end_date =</span> i<span class="sc">$</span>ended,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">rating =</span> i<span class="sc">$</span>rating[[<span class="dv">1</span>]],</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">summary =</span> i<span class="sc">$</span>summary,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">links =</span> i<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>self[<span class="dv">1</span>])</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- Read and Fix function -->
<!-- -   It was originally going to read the json file url and fixes the nodes according to my previous `fix_nodes()` function from before -->
<!-- It's now redundant as I found a better way to do this using `map_dfr()`.  -->
<!-- ```{r, eval = F} -->
<!-- read_and_fix <- function(url) { -->
<!--     show_json_data <- read_json(url) -->
<!--     fix_era_nodes(show_json_data) -->
<!-- } -->
<!-- ``` -->
<p>Extracting the necessary json links directly (without my <code>get_show_links()</code> function). I used <code>map_dfr()</code> instead. It is a bit overkill because it goes through all 700+ elements just to get 3 links.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>era_links <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    drwho_eras,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">tibble</span>(<span class="at">json_link =</span> .x[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">"era"</span>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>era_links</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 2
  era     json_link                         
  &lt;chr&gt;   &lt;chr&gt;                             
1 Classic https://api.tvmaze.com/shows/766  
2 Revival https://api.tvmaze.com/shows/210  
3 Modern  https://api.tvmaze.com/shows/72724</code></pre>
</div>
</div>
<p>Creating the <code>eras_table</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        era_links<span class="sc">$</span>json_link,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">fix_era_nodes</span>(<span class="fu">read_json</span>(.x))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        era_links[<span class="st">"era"</span>],</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>        era_table</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>era_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 Ã— 12
  era     era_id url   name  type  status average_runtime premiere_date end_date
  &lt;chr&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;   
1 Classic    766 httpâ€¦ Doctâ€¦ Scriâ€¦ Ended               25 1963-11-23    1996-05â€¦
2 Revival    210 httpâ€¦ Doctâ€¦ Scriâ€¦ Ended               48 2005-03-26    2022-10â€¦
3 Modern   72724 httpâ€¦ Doctâ€¦ Scriâ€¦ To Beâ€¦              48 2023-11-25    &lt;NA&gt;    
# â„¹ 3 more variables: rating &lt;dbl&gt;, summary &lt;chr&gt;, links &lt;named list&gt;</code></pre>
</div>
</div>
<p>Cleaning the <code>era_table</code> column structure</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(era_table)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    era_table <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">era_id =</span> <span class="fu">as.factor</span>(era_id),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">era =</span> <span class="fu">as.factor</span>(era),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="fu">as.factor</span>(type),</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">status =</span> <span class="fu">as.factor</span>(status), </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">premiere_date =</span> <span class="fu">ymd</span>(premiere_date), </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">end_date =</span> <span class="fu">ymd</span>(end_date)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="co"># str(era_table)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="era-table-presentation" class="level3">
<h3 class="anchored" data-anchor-id="era-table-presentation">Era Table Presentation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(era_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 7%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 71%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">era</th>
<th style="text-align: left;">era_id</th>
<th style="text-align: left;">url</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">status</th>
<th style="text-align: right;">average_runtime</th>
<th style="text-align: left;">premiere_date</th>
<th style="text-align: left;">end_date</th>
<th style="text-align: right;">rating</th>
<th style="text-align: left;">summary</th>
<th style="text-align: left;">links</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">766</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/766/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">1963-11-23</td>
<td style="text-align: left;">1996-05-12</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revival</td>
<td style="text-align: left;">210</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/210/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">2005-03-26</td>
<td style="text-align: left;">2022-10-23</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Modern</td>
<td style="text-align: left;">72724</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/72724/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">To Be Determined</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">2023-11-25</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/72724</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="creating-the-episode-information-table" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-episode-information-table">Creating the Episode Information Table</h3>
<p>I turned my <code>fix_nodes()</code> and revised it to work for fixing the episode nodes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fix_episode_nodes <span class="ot">&lt;-</span> <span class="cf">function</span>(i) { </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>(<span class="at">episode_id =</span> i<span class="sc">$</span>id, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">url =</span> i<span class="sc">$</span>url, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">name =</span> i<span class="sc">$</span>name, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">season =</span> i<span class="sc">$</span>season,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">episode =</span> i<span class="sc">$</span>number,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> i<span class="sc">$</span>type,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">air_date =</span> i<span class="sc">$</span>airdate,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>           <span class="at">air_time =</span> i<span class="sc">$</span>airtime,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">air_stamp =</span> i<span class="sc">$</span>airstamp,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">runtime =</span> i<span class="sc">$</span>runtime,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">average_rating =</span> i<span class="sc">$</span>rating<span class="sc">$</span>average,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">summary =</span> i<span class="sc">$</span>summary,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">era_link =</span> i<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>map_dfr()</code> along with my <code>fix_nodes()</code> function to create the episode information data in tabular form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    drwho_eras[<span class="fu">c</span>(<span class="st">"Classic"</span>, <span class="st">"Revival"</span>, <span class="st">"Modern"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="sc">~</span> <span class="fu">map_dfr</span>(.x, fix_episode_nodes), <span class="at">.id =</span> <span class="st">"era"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Quick format cleaning</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(episode_information_data)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="ot">&lt;-</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">era =</span> <span class="fu">as.factor</span>(era),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="fu">as.factor</span>(type), </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">episode_id =</span> <span class="fu">as.factor</span>(episode_id),</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">air_date =</span> <span class="fu">ymd</span>(air_date),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">air_stamp =</span> <span class="fu">ymd_hms</span>(air_stamp),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">air_time =</span> <span class="fu">hm</span>(air_time)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="co"># str(episode_information_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="episode-information-table-presentation" class="level3">
<h3 class="anchored" data-anchor-id="episode-information-table-presentation">Episode Information Table Presentation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(episode_information_data, <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 10%">
<col style="width: 5%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 0%">
<col style="width: 1%">
<col style="width: 69%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">era</th>
<th style="text-align: left;">episode_id</th>
<th style="text-align: left;">url</th>
<th style="text-align: left;">name</th>
<th style="text-align: right;">season</th>
<th style="text-align: right;">episode</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">air_date</th>
<th style="text-align: right;">air_time</th>
<th style="text-align: left;">air_stamp</th>
<th style="text-align: right;">runtime</th>
<th style="text-align: right;">average_rating</th>
<th style="text-align: left;">summary</th>
<th style="text-align: left;">era_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">67360</td>
<td style="text-align: left;">https://www.tvmaze.com/episodes/67360/doctor-who-1x01-an-unearthly-child-an-unearthly-child-part-one</td>
<td style="text-align: left;">An Unearthly Child (An Unearthly Child, Part One)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">regular</td>
<td style="text-align: left;">1963-11-23</td>
<td style="text-align: right;">17H 15M 0S</td>
<td style="text-align: left;">1963-11-23 17:15:00</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">67361</td>
<td style="text-align: left;">https://www.tvmaze.com/episodes/67361/doctor-who-1x02-the-cave-of-skulls-an-unearthly-child-part-two</td>
<td style="text-align: left;">The Cave of Skulls (An Unearthly Child, Part Two)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">regular</td>
<td style="text-align: left;">1963-11-30</td>
<td style="text-align: right;">17H 15M 0S</td>
<td style="text-align: left;">1963-11-30 17:15:00</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.2</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">67362</td>
<td style="text-align: left;">https://www.tvmaze.com/episodes/67362/doctor-who-1x03-the-forest-of-fear-an-unearthly-child-part-three</td>
<td style="text-align: left;">The Forest of Fear (An Unearthly Child, Part Three)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">regular</td>
<td style="text-align: left;">1963-12-07</td>
<td style="text-align: right;">17H 15M 0S</td>
<td style="text-align: left;">1963-12-07 17:15:00</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">67363</td>
<td style="text-align: left;">https://www.tvmaze.com/episodes/67363/doctor-who-1x04-the-firemaker-an-unearthly-child-part-four</td>
<td style="text-align: left;">The Firemaker (An Unearthly Child, Part Four)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">regular</td>
<td style="text-align: left;">1963-12-14</td>
<td style="text-align: right;">17H 15M 0S</td>
<td style="text-align: left;">1963-12-14 17:15:00</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">67364</td>
<td style="text-align: left;">https://www.tvmaze.com/episodes/67364/doctor-who-1x05-the-dead-planet-the-daleks-part-one</td>
<td style="text-align: left;">The Dead Planet (The Daleks, Part One)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">regular</td>
<td style="text-align: left;">1963-12-21</td>
<td style="text-align: right;">17H 15M 0S</td>
<td style="text-align: left;">1963-12-21 17:15:00</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.6</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="season-information-table" class="level3">
<h3 class="anchored" data-anchor-id="season-information-table">Season Information Table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>season_information_data <span class="ot">&lt;-</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(era, season) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>( </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">amount_of_episodes =</span> <span class="fu">length</span>(episode),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">runtime_of_season =</span> <span class="fu">sum</span>(runtime),</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">average_runtime_per_episode =</span> <span class="fu">sum</span>(runtime)<span class="sc">/</span><span class="fu">length</span>(episode), </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">average_season_rating =</span> <span class="fu">sum</span>(average_rating)<span class="sc">/</span><span class="fu">length</span>(episode)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(season_information_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 18%">
<col style="width: 17%">
<col style="width: 27%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">era</th>
<th style="text-align: right;">season</th>
<th style="text-align: right;">amount_of_episodes</th>
<th style="text-align: right;">runtime_of_season</th>
<th style="text-align: right;">average_runtime_per_episode</th>
<th style="text-align: right;">average_season_rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">1050</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.721429</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.146154</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">1125</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">7.546667</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">1075</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.081395</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">1000</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.520000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">1100</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">8.577273</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="examining-episode-air-dates" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="examining-episode-air-dates"><span class="header-section-number">2.5</span> Examining Episode Air Dates</h2>
<p>Visually represent the length of time between air dates of adjacent episodes within the same season, across all seasons of Dr.&nbsp;Who. You may need to create a factor to indicate which Dr.&nbsp;Who series is indicated, as there will be a Season 1 for each of the series. Your plot must have appropriate labels and a title.</p>
<hr>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="ot">&lt;-</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(era, season) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">gap_days =</span> <span class="fu">as.numeric</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">difftime</span>(air_stamp, <span class="fu">lag</span>(air_stamp), <span class="at">units =</span> <span class="st">'days'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(era <span class="sc">==</span> <span class="st">'Classic'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> season, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> gap_days, </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">factor</span>(season), </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">factor</span>(season))</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 32 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(era <span class="sc">==</span> <span class="st">'Revival'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> season, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> gap_days, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">factor</span>(season), </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">factor</span>(season))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 13 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>episode_information_data <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(era <span class="sc">==</span> <span class="st">'Modern'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> season, </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> gap_days,</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">fill =</span> <span class="fu">factor</span>(season), </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="fu">factor</span>(season))</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>In 2-3 sentences, explain what conclusions you might draw from the data. What patterns do you notice? Are there data quality issues?</p>
</section>
</section>
<section id="timey-wimey-series-and-episodes" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Timey-Wimey Series and Episodes</h1>
<section id="setting-up" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="setting-up"><span class="header-section-number">3.1</span> Setting Up</h2>
<p>In this section of the assignment, you will work with all of the provided JSON files. Use a functional programming approach to read in all of the files and bind them together.</p>
<hr>
<section id="loading-in-json-files" class="level3">
<h3 class="anchored" data-anchor-id="loading-in-json-files">Loading in json files</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sarah_jane_json <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">'sarahjane-970.json'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>torchwood_659_json <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">'torchwood-659.json'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>torchwood_26694_json <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">'torchwood-26694.json'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="binding-all-json-files-together-into-one-big-list" class="level3">
<h3 class="anchored" data-anchor-id="binding-all-json-files-together-into-one-big-list">Binding ALL json files together into one big list</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>timey_wimey_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Classic"</span> <span class="ot">=</span> drwho1963,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Revival"</span> <span class="ot">=</span> drwho2005,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Modern"</span> <span class="ot">=</span> drwho2023,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sarah Jane Adventures'</span> <span class="ot">=</span> sarah_jane_json,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Torchwood'</span> <span class="ot">=</span> torchwood_659_json,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Torchwood Web of Lies'</span> <span class="ot">=</span> torchwood_26694_json</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>Then, use the processing code you wrote for the previous section to perform appropriate data cleaning steps. At the end of the chunk, your data should be in a reasonably tidy, rectangular form with appropriate data types. Call this rectangular table <code>whoverse</code>.</p>
<hr>
</section>
<section id="scraping-the-links-to-create-the-new-eras_data-table" class="level3">
<h3 class="anchored" data-anchor-id="scraping-the-links-to-create-the-new-eras_data-table">Scraping the links to create the new <code>eras_data</code> table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>era_links <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    timey_wimey_list,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">tibble</span>(<span class="at">json_link =</span> .x[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">"era"</span>  </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>era_links</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 2
  era                   json_link                         
  &lt;chr&gt;                 &lt;chr&gt;                             
1 Classic               https://api.tvmaze.com/shows/766  
2 Revival               https://api.tvmaze.com/shows/210  
3 Modern                https://api.tvmaze.com/shows/72724
4 Sarah Jane Adventures https://api.tvmaze.com/shows/970  
5 Torchwood             https://api.tvmaze.com/shows/659  
6 Torchwood Web of Lies https://api.tvmaze.com/shows/26694</code></pre>
</div>
</div>
</section>
<section id="pulling-information-i-need-from-those-links-to-make-the-table" class="level3">
<h3 class="anchored" data-anchor-id="pulling-information-i-need-from-those-links-to-make-the-table">Pulling information I need from those links to make the table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>        era_links<span class="sc">$</span>json_link,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">fix_era_nodes</span>(<span class="fu">read_json</span>(.x))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        era_links[<span class="st">"era"</span>],</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>        era_table</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>era_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 Ã— 12
  era     era_id url   name  type  status average_runtime premiere_date end_date
  &lt;chr&gt;    &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;            &lt;int&gt; &lt;chr&gt;         &lt;chr&gt;   
1 Classic    766 httpâ€¦ Doctâ€¦ Scriâ€¦ Ended               25 1963-11-23    1996-05â€¦
2 Revival    210 httpâ€¦ Doctâ€¦ Scriâ€¦ Ended               48 2005-03-26    2022-10â€¦
3 Modern   72724 httpâ€¦ Doctâ€¦ Scriâ€¦ To Beâ€¦              48 2023-11-25    &lt;NA&gt;    
4 Sarah â€¦    970 httpâ€¦ The â€¦ Scriâ€¦ Ended               30 2007-01-01    2020-04â€¦
5 Torchwâ€¦    659 httpâ€¦ Torcâ€¦ Scriâ€¦ Ended               53 2006-10-22    2011-09â€¦
6 Torchwâ€¦  26694 httpâ€¦ Torcâ€¦ Animâ€¦ Ended                3 2011-07-08    2011-09â€¦
# â„¹ 3 more variables: rating &lt;dbl&gt;, summary &lt;chr&gt;, links &lt;named list&gt;</code></pre>
</div>
</div>
</section>
<section id="creating-the-who_verse_episode-table" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-who_verse_episode-table">Creating the who_verse_episode table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>who_verse_episode_data <span class="ot">&lt;-</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    timey_wimey_list[</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(<span class="st">"Classic"</span>, <span class="st">"Revival"</span>, <span class="st">"Modern"</span>, <span class="st">"Sarah Jane Adventures"</span>, <span class="st">"Torchwood"</span>, <span class="st">"Torchwood Web of Lies"</span>)] <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(<span class="sc">~</span> <span class="fu">map_dfr</span>(.x, fix_episode_nodes), <span class="at">.id =</span> <span class="st">"era"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="quick-column-format-cleaning" class="level4">
<h4 class="anchored" data-anchor-id="quick-column-format-cleaning">Quick column format cleaning</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>who_verse_episode_data <span class="ot">&lt;-</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    who_verse_episode_data <span class="sc">%&gt;%</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">era =</span> <span class="fu">as.factor</span>(era),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="fu">as.factor</span>(type), </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">episode_id =</span> <span class="fu">as.factor</span>(episode_id),</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">air_date =</span> <span class="fu">ymd</span>(air_date),</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">air_stamp =</span> <span class="fu">ymd_hms</span>(air_stamp)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># air_time = hm(air_time)</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
</section>
<section id="air-time" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="air-time"><span class="header-section-number">3.2</span> Air Time</h2>
<p>Investigate the air time of the episodes relative to the air date, series, and season. It may help to know that the <a href="https://en.wikipedia.org/wiki/Watershed_(broadcasting)">watershed</a> period in the UK is 9:00pm - 5:30am. - <strong>Military Times: 21:00 - 5:30</strong> Content that is unsuitable for minors may only be shown during this window. What conclusions do you draw about the target audience for each show?</p>
<p>How can you explain any shows in the Dr.&nbsp;Who universe which do not have airtimes provided?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>who_verse_episode_data <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">x =</span> air_time, <span class="at">y =</span> episode, <span class="at">fill =</span> era</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">'identity'</span>, <span class="at">width =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scale_x_discrete(guide = guide_axis(n.dodge = 4)) + </span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">"time of airing"</span>, </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">'amount of episodes'</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">'Amount of episodes airing at certain times'</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-layer-of-json" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="another-layer-of-json"><span class="header-section-number">3.3</span> Another Layer of JSON</h2>
<p>Use the show URL (<code>_links</code> &gt; <code>show</code> &gt; <code>href</code>) to read in the JSON file for each show. As with scraping, it is important to be polite and not make unnecessary server calls, so pre-process the data to ensure that you only make one server call for each show. You should use a functional programming approach when reading in these files.</p>
<hr>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>I think I accidentally did this first with my <code>era_table</code> dataframe?</p>
</div>
</div>
</div>
<section id="gettings-the-links-in-an-easy-to-findgrab-spot" class="level3">
<h3 class="anchored" data-anchor-id="gettings-the-links-in-an-easy-to-findgrab-spot">Gettings the links in an easy to find/grab spot</h3>
<p>I believe this is polite, as it is taking the each element in the big list (Classic, Revival, Modernâ€¦etc) and only taking the link to the showâ€™s json file from the first entry in that element. So I think Iâ€™m making only one server call for each era/show.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>era_links <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    timey_wimey_list,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> <span class="fu">tibble</span>(<span class="at">json_link =</span> .x[[<span class="dv">1</span>]]<span class="sc">$</span><span class="st">`</span><span class="at">_links</span><span class="st">`</span><span class="sc">$</span>show<span class="sc">$</span>href),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">"era"</span>  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(era_links,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">era</th>
<th style="text-align: left;">json_link</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revival</td>
<td style="text-align: left;">https://api.tvmaze.com/shows/210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Modern</td>
<td style="text-align: left;">https://api.tvmaze.com/shows/72724</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sarah Jane Adventures</td>
<td style="text-align: left;">https://api.tvmaze.com/shows/970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Torchwood</td>
<td style="text-align: left;">https://api.tvmaze.com/shows/659</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
<p>Process the JSON files using a functional approach and construct an appropriate table for the combined data youâ€™ve acquired during this step (no need to join the data with the full <code>whoverse</code> episode-level data).</p>
<hr>
</section>
<section id="pulling-information-i-need-from-those-links-to-make-the-table-1" class="level3">
<h3 class="anchored" data-anchor-id="pulling-information-i-need-from-those-links-to-make-the-table-1">Pulling information I need from those links to make the table</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map_dfr</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        era_links<span class="sc">$</span>json_link,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> <span class="fu">fix_era_nodes</span>(<span class="fu">read_json</span>(.x))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>era_table <span class="ot">&lt;-</span> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_cols</span>(</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>        era_links[<span class="st">"era"</span>],</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        era_table</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(era_table,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 8%">
<col style="width: 3%">
<col style="width: 1%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 1%">
<col style="width: 1%">
<col style="width: 67%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">era</th>
<th style="text-align: right;">era_id</th>
<th style="text-align: left;">url</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">status</th>
<th style="text-align: right;">average_runtime</th>
<th style="text-align: left;">premiere_date</th>
<th style="text-align: left;">end_date</th>
<th style="text-align: right;">rating</th>
<th style="text-align: left;">summary</th>
<th style="text-align: left;">links</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classic</td>
<td style="text-align: right;">766</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/766/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">1963-11-23</td>
<td style="text-align: left;">1996-05-12</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/766</td>
</tr>
<tr class="even">
<td style="text-align: left;">Revival</td>
<td style="text-align: right;">210</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/210/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">2005-03-26</td>
<td style="text-align: left;">2022-10-23</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/210</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Modern</td>
<td style="text-align: right;">72724</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/72724/doctor-who</td>
<td style="text-align: left;">Doctor Who</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">To Be Determined</td>
<td style="text-align: right;">48</td>
<td style="text-align: left;">2023-11-25</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/72724</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sarah Jane Adventures</td>
<td style="text-align: right;">970</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/970/the-sarah-jane-adventures</td>
<td style="text-align: left;">The Sarah Jane Adventures</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">2007-01-01</td>
<td style="text-align: left;">2020-04-19</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Torchwood</td>
<td style="text-align: right;">659</td>
<td style="text-align: left;">https://www.tvmaze.com/shows/659/torchwood</td>
<td style="text-align: left;">Torchwood</td>
<td style="text-align: left;">Scripted</td>
<td style="text-align: left;">Ended</td>
<td style="text-align: right;">53</td>
<td style="text-align: left;">2006-10-22</td>
<td style="text-align: left;">2011-09-09</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">https://api.tvmaze.com/shows/659</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
<p>What keys would you use to join this data with the <code>whoverse</code> episode level data? Explain.</p>
<ul>
<li><p>I would use the <code>era</code>, <code>era_id</code>, and/or even the <code>era_links</code>/<code>links</code> variable.</p></li>
<li><p>That way, despite there being many season 1 episode 1â€™s, you would know exactly what show/era the row the data is telling you.</p></li>
</ul>
</section>
</section>
<section id="explore" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="explore"><span class="header-section-number">3.4</span> Explore!</h2>
<p>Use the data youâ€™ve assembled to answer a question you find interesting about this data. Any graphics you make should have appropriate titles and axis labels. Tables should be reasonably concise (e.g.&nbsp;donâ€™t show all 900 episodes in a table), generated in a reproducible fashion, and formatted with markdown. Any results (graphics, tables, models) should be explained with at least 2-3 sentences.</p>
<p>If youâ€™re stuck, consider examining the frequency of words in the episode descriptions across different series or seasons. Or, look at the episode guest cast by appending <code>/guestcast/</code> to the episode URL and see whether there are common guests across different seasons.</p>
<hr>
<hr>
<p>Code goes here â€“ once you output a result, you should explain it using markdown text, and then start a new code chunk to continue your exploration.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>